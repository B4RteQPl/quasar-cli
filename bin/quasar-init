#!/usr/bin/env node

const parseArgs = require('minimist')

const argv = parseArgs(process.argv.slice(2), {
  alias: {
    h: 'help'
  },
  boolean: ['h']
})

if (argv.help) {
  console.log(`
    Description
      Create a Quasar App folder from the starter kit.
      You need "vue-cli" package installed globally.
    Usage
      $ quasar init <folder_name>
    Options
      --help, -h     Displays this message
  `)
  process.exit(0)
}

const
  logger = require('../lib/helpers/logger'),
  log = logger('app:init'),
  warn = logger('app:init', 'red'),
  appPaths = require('../lib/build/app-paths'),
  spawn = require("child_process").spawn

try {
  console.log(` Running command: vue init ${appPaths.resolve.cli('templates/starter-kit')} ${argv._[0]}`)
  spawn('vue', [
    'init',
    appPaths.resolve.cli('templates/starter-kit'),
    argv._[0]
  ], { stdio: ['inherit', 'inherit', 'inherit'] })
}
catch (err) {
  console.log(err)
  warn('Vue CLI not installed globally')
  warn('Please run "npm i -g vue-cli" and then try again.')
}
